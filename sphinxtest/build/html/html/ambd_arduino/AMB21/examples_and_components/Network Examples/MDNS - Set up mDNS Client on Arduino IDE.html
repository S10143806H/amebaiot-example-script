<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MDNS - Set up mDNS Client on Arduino IDE &mdash; 123 123 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="MQTT - Set up MQTT Client to Communicate with Broker" href="MQTT%20-%20Set%20up%20MQTT%20Client%20to%20Communicate%20with%20Broker.html" />
    <link rel="prev" title="IPv6 – Ameba as IPv6 Server/Client over UDP" href="IPv6%20-%20Ameba%20as%20IPv6%20Server%20Client%20over%20UDP.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> 123
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Open Source SDKs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../arduino_index.html">Arduino SDK</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">AMB21/AMB22 (RTL8722DM/RTL8722CSM)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/ambd_getting_started.html">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_history/Release_History.html">Release History</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Examples &amp; Components</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../Basic%20Examples.html">Basic Examples</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Network Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Peripheral%20Examples/index.html">Peripheral Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Community%20Examples/index.html">Community Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Components%20Used.html">Components Used</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_documents/index.html">API Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../resources/index.html">Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../support/index.html">Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../AMB23/index.html">AMB23 (RTL8722DM MINI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../BW16_/index.html">BW16 (RTL8720DN)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ambd_micropython/micropython_index.html">MicroPython SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ambd_sdk/source/index.html">Standard SDK</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Download</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../download/AMB21_download.html">AMB21/AMB22 (RTL8722DM/RTL8722CSM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../download/AMB23_download.html">AMB23 (RTL8722DM MINI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../download/BW16_download.html">BW16 (RTL8720DN)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">123</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../arduino_index.html">Arduino SDK</a> &raquo;</li>
          <li><a href="../../index.html">AMB21/AMB22 (RTL8722DM/RTL8722CSM)</a> &raquo;</li>
          <li><a href="../index.html">Examples &amp; Components</a> &raquo;</li>
          <li><a href="index.html">Network Examples</a> &raquo;</li>
      <li>MDNS - Set up mDNS Client on Arduino IDE</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/ambd_arduino/AMB21/examples_and_components/Network Examples/MDNS - Set up mDNS Client on Arduino IDE.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mdns-set-up-mdns-client-on-arduino-ide">
<h1>MDNS - Set up mDNS Client on Arduino IDE<a class="headerlink" href="#mdns-set-up-mdns-client-on-arduino-ide" title="Permalink to this heading"></a></h1>
<p><span class="raw-html"><p style="color:#E67E22; font-size:24px"></span>
<strong>Preparation</strong>
<span class="raw-html"></p></span></p>
<blockquote>
<div><ul class="simple">
<li><p>AmebaD [AMB21 / AMB22 / AMB23 / BW16] x 1</p></li>
</ul>
</div></blockquote>
<p><span class="raw-html"><p style="color:#E67E22; font-size:24px"></span>
<strong>Example</strong>
<span class="raw-html"></p></span></p>
<p>mDNS (Multicast DNS) is a protocol used in the local area network. It
delivers the network information like IP address and provided services
to others. mDNS is based on the UDP protocol, and it sends packets to
224.0.0.251 with port 5353 under IPv4 address. The naming style for the
service follows the format: <strong>{Instance Name}.{Protocol Name}.{Domain}</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Instance Name: used to identify the name of the service</p></li>
<li><p>Protocol Name: Divided into two parts, the front end is in regard to
the name of the service, and it adds baseline as a prefix. The
rear end is in regard to the transport protocol name it used, and
it also adds baseline as a prefix</p></li>
<li><p>Domain: Local area network in normal cases</p></li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line">For example, Arduino IDE adopts the naming for the mDNS service which is
used in OTA as following: <strong>MyAmeba._arduino._tcp.local</strong></div>
<div class="line">Among the
naming example, “MyAmeba” can identify the Ameba device name and the
name “MyAmeba” is changeable. “_arduino._tcp” is the protocol that
Arduino IDE adopts, and the Domain is set as local in common.</div>
<div class="line">Open the example, <code class="docutils literal notranslate"><span class="pre">“File”</span> <span class="pre">-&gt;</span> <span class="pre">“Examples”</span> <span class="pre">-&gt;</span> <span class="pre">“AmebaMDNS”</span> <span class="pre">-&gt;</span> <span class="pre">“mdns_on_arduino_ide”</span></code></div>
<div class="line">You need to input ssid and password of the AP because the example will
use WiFi connection.</div>
<div class="line">And you can find out the naming of the service at
the place where it declares MDNS Service. The example uses the default
name “MyAmeba” and the name is changeable.</div>
<div class="line"><a class="reference internal" href="../../../../_images/image116.png"><img alt="1" src="../../../../_images/image116.png" style="width: 679.0px; height: 623.0px;" /></a></div>
</div>
<p>Next, go to (“Tools” -&gt;
“Port”), and you can find out at least one Serial Port. This port is
simulated by Ameba board via USB. Choose this port and upload the
compiled code to Ameba.</p>
<p><a class="reference internal" href="../../../../_images/image214.png"><img alt="2" src="../../../../_images/image214.png" style="width: 679.0px; height: 853.0px;" /></a></p>
<p>After uploading the code, press the reset
button on Ameba and waiting for Ameba to connect with AP and activate
the mDNS service after a while. You can see the Log at the bottom of the
Serial Monitor.</p>
<p><a class="reference internal" href="../../../../_images/image310.png"><img alt="3" src="../../../../_images/image310.png" style="width: 704.0px; height: 355.0px;" /></a></p>
<p>Then you can find out the added item “Network
Ports” <strong>“MyAmeba at 192.168.1.167 (Ameba RTL8722DM/RTL8722CSM)”</strong>,
“MyAmeba” is the device name we set up, and “IP” is the IP address that
AP assigned to Ameba, the IP address should be the same with the IP
shown in the Serial Monitor. Last, “Ameba RTL8722DM/RTL8722CSM” is the
type name of the board, and it means that Ameba can let Arduino IDE
identify the mDNS service successfully.(We still can not use the
Internet to upload the code, and we will explain this part in the OTA
example.)<a class="reference internal" href="../../../../_images/image48.png"><img alt="4" src="../../../../_images/image48.png" style="width: 777.0px; height: 853.0px;" /></a></p>
<div class="line-block">
<div class="line">If you cannot find the Network ports on your Arduino IDE, please check：</div>
</div>
<blockquote>
<div><ul class="simple">
<li><p>Does your computer in the same local area network with the Ameba?</p></li>
<li><p>Restart the Arduino IDE, and it will find the mDNS service again</p></li>
<li><p>Check the Log in Serial Monitor if the Ameba connects to the AP and
activate mDNS service successfully</p></li>
</ul>
</div></blockquote>
<p><span class="raw-html"><p style="color:#E67E22; font-size:24px"></span>
<strong>Code Reference</strong>
<span class="raw-html"></p></span></p>
<p>The program set up the mDNS service in the beginning, the first
parameter is Instance Name, and it is changeable in this example. The
second parameter is the protocol that the service used, and it would be
“_arduino._tcp” for Arduino IDE. The third parameter is Domain, and it
would be “local” in common. The fourth parameter is the port number for
the service, it is 5000 here and we doesn’t use it in the example.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">MDNSService</span><span class="w"> </span><span class="nf">service</span><span class="p">(</span><span class="s">&quot;MyAmeba&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;_arduino._tcp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>After connected to the network, we set up some text fields for the
service. For the following example, “board” is the name of the field,
“ameba_rtl8721d” is the value of the field. “board” is used to let
Arduino IDE check installed SDK to see if it exists known device or not.
We will use the name of the device if there is known device, users can
change “ameba_rtl8721d” to “yun” or other names to find out what’s the
difference if interested.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">service</span><span class="p">.</span><span class="n">addTxtRecord</span><span class="p">(</span><span class="s">&quot;board&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;ameba_rtl8721d&quot;</span><span class="p">),</span><span class="s">&quot;ameba_rtl8721d&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Then we add three text fields “auth_upload”, “tcp_check”, and
“ssh_upload”, this example does not activate these services.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">service</span><span class="p">.</span><span class="n">addTxtRecord</span><span class="p">(</span><span class="s">&quot;auth_upload&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;no&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">service</span><span class="p">.</span><span class="n">addTxtRecord</span><span class="p">(</span><span class="s">&quot;tcp_check&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;no&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">service</span><span class="p">.</span><span class="n">addTxtRecord</span><span class="p">(</span><span class="s">&quot;ssh_upload&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;no&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Next we activate MDNS</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">MDNS</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>and register to the mDNS service.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">MDNS</span><span class="p">.</span><span class="n">registerService</span><span class="p">(</span><span class="n">service</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="IPv6%20-%20Ameba%20as%20IPv6%20Server%20Client%20over%20UDP.html" class="btn btn-neutral float-left" title="IPv6 – Ameba as IPv6 Server/Client over UDP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MQTT%20-%20Set%20up%20MQTT%20Client%20to%20Communicate%20with%20Broker.html" class="btn btn-neutral float-right" title="MQTT - Set up MQTT Client to Communicate with Broker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, 123.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>